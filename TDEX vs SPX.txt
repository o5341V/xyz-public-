// This source code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© Uni_ve12se

//@version=5
strategy("TDEX vs SPX", overlay=true)

zscoreH =(high -ta.ema(high, 30)) / ta.stdev(high,30)
zSPX = nz(request.security("SPX","1D", ta.ema(zscoreH,3), barmerge.gaps_on,barmerge.lookahead_on))
zVOLI = nz(request.security("NASDAQ:TDEX","1D", zscoreH, barmerge.gaps_on,barmerge.lookahead_on))

plot(zVOLI-zSPX, title="diff", color=color.blue)
plot(zscoreH, color=color.blue, title="z")
barcolor(ta.crossunder(zVOLI-zSPX, 2) ? color.green:zVOLI-zSPX>2 ? color.yellow:color.black)
plotshape(ta.crossunder(zVOLI-zSPX, 2)==true, title='bull', style=shape.triangleup,location=location.belowbar, color=color.white, size=size.tiny, transp=75) 