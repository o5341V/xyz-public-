// This source code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© Uni_ve12se

//@version=4
study("Ralph Haller Statistical Analysis Framework")

mutual1A = close
mutual1At = input(0)
mutual1B = open
mutual1Bt = input(0)

C1 = mutual1A[mutual1At] > mutual1B[mutual1Bt]
notC1 = not C1

mutualSeries = C1[1] and C1[2] and C1[3] and C1[4] and C1[5] and C1[6] and C1[7] and notC1[8]

target1A = input(close)
target1At = input(0)
target1B = input(open)
target1Bt = input(0)

targetCondition = target1A[target1At] > target1B[target1Bt]

seriesTarget = mutualSeries and targetCondition
notSeriesTarget = not seriesTarget

seriesControl = mutualSeries and not targetCondition
notSeriesControl = not seriesControl

barcolor(seriesTarget ? color.lime : na, title="Desired Outcome")
barcolor(seriesControl ? color.maroon : na, title="Not Desired Outcome")

lookback = input(1500)

target = seriesTarget ? 1 : 0
control = seriesControl ? 1 : 0
//comparison = HallerGreen == HeikGreen ? 1 : 0
percentage = (sum(target, lookback)/((sum(target, lookback)+sum(control, lookback)))*100)

plotshape(seriesTarget ? percentage : na , text='v', color=color.lime, title="Mark Desired Outcome", location=location.absolute)
plotshape(seriesControl ? percentage : na, text='x', color=color.white, title="Mark Not Desired Outcome", location=location.absolute)

//plot(comparison, color=color.white, style=plot.style_histogram, display=display.none)
plot(percentage, title="Occurrence Percentage", color=color.lime, style=plot.style_line)
