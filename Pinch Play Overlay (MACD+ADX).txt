// This source code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// © Sascha Sambale

//@version=5
indicator(title='SlhTgh MACD ADX', shorttitle='Pinch', overlay=true, timeframe='')

// Getting inputs
fast_length = input(title='Fast Length', defval=12)
slow_length = input(title='Slow Length', defval=26)
src = input(title='Source', defval=close)
signal_length = input.int(title='Signal Smoothing', minval=1, maxval=50, defval=9)
// adx inputs
adxlen = input(14, title='ADX Smoothing')
dilen = input(14, title='DI Length')
dirmov(len) =>
    up = ta.change(high)
    down = -ta.change(low)
    plusDM = na(up) ? na : up > down and up > 0 ? up : 0
    minusDM = na(down) ? na : down > up and down > 0 ? down : 0
    truerange = ta.rma(ta.tr, len)
    plus = fixnan(100 * ta.rma(plusDM, len) / truerange)
    minus = fixnan(100 * ta.rma(minusDM, len) / truerange)
    [plus, minus]
adx(dilen, adxlen) =>
    [plus, minus] = dirmov(dilen)
    sum = plus + minus
    adx = 100 * ta.rma(math.abs(plus - minus) / (sum == 0 ? 1 : sum), adxlen)
    adx
sig = adx(dilen, adxlen)


// Plot colors
col_grow_above = #26A69A
col_grow_below = #FFCDD2
col_fall_above = #B2DFDB
col_fall_below = #EF5350
col_macd = #0094ff
col_signal = #ff6a00


// Calculating
fast_ma = ta.ema(src, fast_length)
slow_ma = ta.ema(src, slow_length)
macd = fast_ma - slow_ma
signal = ta.ema(macd, signal_length)
hist = macd - signal

// Check adx
macd_crossup = macd < 0 and ta.crossover(macd, signal)
macd_crossdown = macd > 0 and ta.crossunder(macd, signal)
bearish = sig > 25 and macd_crossdown

xyz = input(20)
xyz2 = input(25)

bullish1 = sig > xyz and macd_crossup
bullish2 = sig > xyz2 and macd_crossup


//change to > 40 for daily

//alertcondition(bullish, title='Bullish MACD Crossover detected', message="Bullish trend detected")
//alertcondition(bearish, title='Bearish MACD Crossover detected', message='Bearish trend detected')

plotshape(bullish1, color=color.new(color.white, 75), style=shape.circle, location=location.belowbar, size=size.tiny, textcolor=color.new(color.white, 75))  //plot for buy icon
plotshape(bullish2, color=color.new(color.white, 10), style=shape.circle, location=location.belowbar, size=size.tiny, textcolor=color.new(color.white, 10))
//plotshape(bullish3, color=color.white, style=shape.circle, location=location.belowbar, size=size.tiny, textcolor=color.white, transp=10)

//plotshape(bearish, color=color.white, style=shape.circle, location=location.top, size=size.tiny, textcolor=color.white, transp=10)  //plot for sell icon
//
//plotchar(bearish, color=#f44336, char="⬇", location=location.abovebar, size=size.tiny)
//plotchar(bullish, color=#00ffcb, char="⬆", location=location.belowbar, size=size.tiny)
//
//plotshape(bullish, location=location.belowbar, style=shape.cross, color=#00ffcb, size=size.tiny, transp=0, offset=-1)
//plotshape(bearish, location=location.abovebar, style=shape.xcross, color=#f44336, size=size.tiny, transp=0, offset=-1)

//if bullish
//    strategy.entry("buy", strategy.long)
//if bearish
//    strategy.entry("sell", strategy.short)

backgroundColour1 = bullish1 == true ? color.white : na

//bgcolor(color=backgroundColour1, transp=85, offset=-1)

