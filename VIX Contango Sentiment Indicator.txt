//@version=5
indicator('VIX Contango Slope Indicator', overlay=false)


sym0 = input.symbol(title='Symbol', defval='VIX')
sym1 = input.symbol(title='Symbol', defval='VIX3m')

//hline(1.1, title='Capitulation', color=color.green, linestyle=hline.style_dotted, linewidth=2)
//hline(1, title='Fear', color=color.green, linestyle=hline.style_dotted, linewidth=2)
//hline(0.8, title='Complacency', color=color.red, linestyle=hline.style_dotted, linewidth=2)
RAT0 = request.security(sym0, timeframe.period, close, barmerge.gaps_on, barmerge.lookahead_on)
RAT1 = request.security(sym1, timeframe.period, close, barmerge.gaps_on, barmerge.lookahead_on)
//plot(ema(close,ema1) >= ema(close,ema2)-Dist and ema(close,ema1) <= ema(close,ema2)+Dist? close : na, title="Column signal for convergence", color = purple, style = columns, linewidth = 2)
//plot((RAT0 / RAT1) >= OUT0, color = white, style = line, linewidth = 1)

MOV0 = input(title='EMA Period', defval=252)
MOV1 = input(title='EMA Period', defval=3)

k = ta.hma(RAT0 / RAT1, MOV0)
b = ta.hma(RAT0 / RAT1, MOV1)
b2 = ta.stdev(RAT0 / RAT1, MOV1)

plot(k, color=color.new(color.black, 0), style=plot.style_line, linewidth=1)

data = MOV1 < .8

plot(b, color=color.new(color.blue, 0), style=plot.style_line, linewidth=1)
//plot(b2, color=color.new(color.blue, 0), style=plot.style_line, linewidth=1)


[bbMiddle, bbUpper, bbLower] = ta.bb(b, input(1440), 2)

plot(bbUpper, title='Capitulation', color=color.black)
//plot(bbLower, color=color.gray)
//plot(bbMiddle, color=color.gray)

bgcolor(b > k ? color.red : color.white, transp=80)

